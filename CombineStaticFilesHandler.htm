
<!-- saved from url=(0085)http://webcontent:9999/EsccWebTeam.Egms/html/10c0c761-c130-a524-7e93-a9b6103567d9.htm -->
<html xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="save" content="history"><title>CombineStaticFilesHandler Class</title><meta name="Language" content="en-us"><meta name="System.Keywords" content="CombineStaticFilesHandler class"><meta name="System.Keywords" content="EsccWebTeam.Egms.CombineStaticFilesHandler class"><meta name="System.Keywords" content="CombineStaticFilesHandler class, about CombineStaticFilesHandler class"><meta name="Microsoft.Help.F1" content="EsccWebTeam.Egms.CombineStaticFilesHandler"><meta name="Microsoft.Help.Id" content="T:EsccWebTeam.Egms.CombineStaticFilesHandler"><meta name="Description" content="Include a combined and cached set of CSS or JavaScript files in the page"><meta name="Microsoft.Help.ContentType" content="Reference"><link rel="stylesheet" type="text/css" href="./CombineStaticFilesHandler_files/presentation.css"><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css"><script type="text/javascript" src="./CombineStaticFilesHandler_files/EventUtilities.js"> </script><script type="text/javascript" src="./CombineStaticFilesHandler_files/SplitScreen.js"> </script><script type="text/javascript" src="./CombineStaticFilesHandler_files/Dropdown.js"> </script><script type="text/javascript" src="./CombineStaticFilesHandler_files/script_manifold.js"> </script><script type="text/javascript" src="./CombineStaticFilesHandler_files/script_feedBack.js"> </script><script type="text/javascript" src="./CombineStaticFilesHandler_files/CheckboxMenu.js"> </script><script type="text/javascript" src="./CombineStaticFilesHandler_files/CommonUtilities.js"> </script><meta name="container" content="EsccWebTeam.Egms"><meta name="file" content="10c0c761-c130-a524-7e93-a9b6103567d9"><meta name="guid" content="10c0c761-c130-a524-7e93-a9b6103567d9"></head><body style="margin: 0px; overflow: hidden;"><xml><mshelp:attr name="AssetID" value="T:EsccWebTeam.Egms.CombineStaticFilesHandler"><mshelp:toctitle title="CombineStaticFilesHandler Class"><mshelp:rltitle title="CombineStaticFilesHandler Class (EsccWebTeam.Egms)"><mshelp:keyword index="A" term="T:EsccWebTeam.Egms.CombineStaticFilesHandler"><mshelp:keyword index="A" term="frlrfEsccWebTeamEgmsCombineStaticFilesHandlerClassTopic"><mshelp:keyword index="K" term="CombineStaticFilesHandler class"><mshelp:keyword index="K" term="EsccWebTeam.Egms.CombineStaticFilesHandler class"><mshelp:keyword index="K" term="CombineStaticFilesHandler class, about CombineStaticFilesHandler class"><mshelp:keyword index="F" term="EsccWebTeam.Egms.CombineStaticFilesHandler"><mshelp:attr name="HelpPriority" value="2"><mshelp:attr name="APIType" value="Managed"><mshelp:attr name="APILocation" value="EsccWebTeam.Egms.dll"><mshelp:attr name="APIName" value="EsccWebTeam.Egms.CombineStaticFilesHandler"><mshelp:attr name="DevLang" value="CSharp"><mshelp:attr name="DevLang" value="VB"><mshelp:attr name="Locale" value="en-us"><mshelp:attr name="TopicType" value="kbSyntax"><mshelp:attr name="TopicType" value="apiref"><mshelp:attr name="Abstract" value="Include a combined and cached set of CSS or JavaScript files in the page"><mshelp:attr name="AssemblyVersion" value="1.0.0.0"></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:attr></mshelp:keyword></mshelp:keyword></mshelp:keyword></mshelp:keyword></mshelp:keyword></mshelp:keyword></mshelp:rltitle></mshelp:toctitle></mshelp:attr></xml><link type="text/css" rel="stylesheet" href="./CombineStaticFilesHandler_files/highlight.css"><script type="text/javascript" src="./CombineStaticFilesHandler_files/highlight.js"> </script><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"><img id="collapseImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image" title="Collapse image"><img id="expandImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/expand_all.gif" alt="Expand Image" title="Expand Image"><img id="collapseAllImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/collapse_all.gif"><img id="expandAllImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/expand_all.gif"><img id="dropDownImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/dropdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/dropdownHover.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/copycode.gif" alt="Copy image" title="Copy image"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="./CombineStaticFilesHandler_files/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image"><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tbody><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img id="toggleAllImage" class="toggleAll" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="">&nbsp;<label id="collapseAllLabel" for="toggleAllImage" style="display: inline;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label>&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="./CombineStaticFilesHandler_files/dropdown.gif">&nbsp;<label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: inline;"><nobr>Code: All&nbsp;</nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple&nbsp;</nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C#&nbsp;</nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic&nbsp;</nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++&nbsp;</nobr></label></span></td></tr></tbody></table><div id="devlangsMenu" style="visibility: hidden; position: absolute; left: 100px; top: 16px;"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,&#39;persist&#39;" value="on" onclick="SetLanguage(this)"><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,&#39;persist&#39;" value="on" onclick="SetLanguage(this)"><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,&#39;persist&#39;" value="on" onclick="SetLanguage(this)"><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tbody><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">A Sandcastle Documented Class Library</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">CombineStaticFilesHandler Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="http://webcontent:9999/EsccWebTeam.Egms/html/0f717c85-76a2-15c0-c41f-9fb70808d06a.htm">Members</a>&nbsp;<a href="http://webcontent:9999/EsccWebTeam.Egms/html/10c0c761-c130-a524-7e93-a9b6103567d9.htm#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See&nbsp;Also</a>&nbsp;<span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('','A Sandcastle Documented Class Library','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></tbody></table><table id="gradientTable"><tbody><tr><td class="nsrBottom" background="./CombineStaticFilesHandler_files/gradient.gif"></td></tr></tbody></table></div><div id="mainSection" style="overflow: auto; height: 846px; width: 1316px;"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"><span style="color: DarkGray"></span><div class="summary">
             Include a combined and cached set of CSS or JavaScript files in the page
             </div><p><b>Namespace:</b>&nbsp;<a href="http://webcontent:9999/EsccWebTeam.Egms/html/a73b95d3-f3f8-c86c-c924-1fc7e87db9f9.htm">EsccWebTeam.Egms</a><br><b>Assembly:</b>&nbsp;<span sdata="assembly">EsccWebTeam.Egms</span> (in EsccWebTeam.Egms.dll) Version: 1.0.0.0</p><h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codelanguage="CSharp"><table><tbody><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">CombineStaticFilesHandler</span> : <span class="nolink">IHttpHandler</span></pre></td></tr></tbody></table></span><span codelanguage="VisualBasicDeclaration"><table><tbody><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">CombineStaticFilesHandler</span> _
	<span class="keyword">Implements</span> <span class="nolink">IHttpHandler</span></pre></td></tr></tbody></table></span><span codelanguage="ManagedCPlusPlus"><table><tbody><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">CombineStaticFilesHandler</span> : <span class="nolink">IHttpHandler</span></pre></td></tr></tbody></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>Combining static files into fewer HTTP requests and caching the result means static files are served faster.</p><p>Start by registering your CSS and JavaScript files in <span class="code">web.config</span>. This is so that you can easily reorganise where they are
             stored on your site without having to update references in each web page, and to use different paths on your live site (for example,
             a minified version). If you're not using this HTTP handler, it also allows you to version your files by changing the filename.</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
  &lt;configSections&gt;
    &lt;sectionGroup name=<span class="highlight-literal">"EsccWebTeam.Egms"</span>&gt;
      &lt;section name=<span class="highlight-literal">"CssFiles"</span> type=<span class="highlight-literal">"System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"</span> /&gt;
      &lt;section name=<span class="highlight-literal">"ScriptFiles"</span> type=<span class="highlight-literal">"System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"</span> /&gt;
    &lt;/sectionGroup&gt;
  &lt;/configSections&gt;

  &lt;EsccWebTeam.Egms&gt;
    &lt;CssFiles&gt;
      &lt;add key=<span class="highlight-literal">"ExampleStyle"</span> value=<span class="highlight-literal">"/example/style.css"</span> /&gt;
    &lt;/CssFiles&gt;

    &lt;ScriptFiles&gt;
      &lt;add key=<span class="highlight-literal">"ExampleScript"</span> value=<span class="highlight-literal">"/example/script.js"</span> /&gt;
      &lt;add key=<span class="highlight-literal">"ExampleScript2"</span> value=<span class="highlight-literal">"/example/script2.js"</span> /&gt;
    &lt;/ScriptFiles&gt;
  &lt;/EsccWebTeam.Egms&gt;
&lt;/configuration&gt;</pre></div></span></div><p>You also need to register the control namespace so that you can put the control on the page.</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_2" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
     &lt;system.web&gt;
       &lt;pages&gt;
         &lt;controls&gt;
           &lt;add tagPrefix=<span class="highlight-literal">"Egms"</span> <span class="highlight-keyword">namespace</span>=<span class="highlight-literal">"EsccWebTeam.Egms"</span> assembly=<span class="highlight-literal">"EsccWebTeam.Egms, Version=1.0.0.0, Culture=neutral, PublicKeyToken=06fad7304560ae6f"</span> /&gt;
         &lt;/controls&gt;
       &lt;/pages&gt;
     &lt;/system.web&gt;
&lt;/configuration&gt;</pre></div></span></div><p>Now you can use the <a href="http://webcontent:9999/EsccWebTeam.Egms/html/cc589405-b1f1-9004-045b-bf9787a7512d.htm">Css</a> and <a href="http://webcontent:9999/EsccWebTeam.Egms/html/a0649da7-f2d9-34be-e024-35f86530b6e5.htm">Script</a> controls on your page. You can reference multiple files with one tag by separating the keys with semi-colons.
             You can also restrict the file(s) to only certain users using the <a href="http://webcontent:9999/EsccWebTeam.Egms/html/f9217775-7f23-f074-fa91-47378483fa55.htm">RestrictToGroups</a> property.</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_3" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;Egms:Css runat=<span class="highlight-literal">"server"</span> Files=<span class="highlight-literal">"ExampleStyle"</span> /&gt;
&lt;Egms:Script runat=<span class="highlight-literal">"server"</span> Files=<span class="highlight-literal">"ExampleScript;ExampleScript2"</span> /&gt;</pre></div></span></div><p>These controls will output ordinary &lt;link /&gt; and &lt;script&gt;&lt;/script&gt; elements. CSS files will be linked from the page &lt;head&gt;&lt;/head&gt; so
             long as the &lt;head&gt;&lt;/head&gt; element has <span class="code">runat="server"</span> applied.</p><p><b>Configuring the HTTP handler</b></p><p>To take advantage of combining and caching static files, you need to configure the HTTP handler.</p><b>In IIS 6:</b><ul><li>Go to the application root from where you want to serve static files. This will typically be the root of the website. Right-click and select <span class="code">Properties</span>.</li><li>On the <span class="code">Home directory</span> tab, click the <span class="code">Configuration</span> button.</li><li>Open the entry for any ASP.NET file type and copy the path to the ISAPI filter.</li><li>Click <span class="code">Add</span> to create a new mapping, and paste the ISAPI path into the <span class="code">Executable</span> field.</li><li>Enter a file extension, which must include the string <span class="code">"css"</span> or <span class="code">"js"</span> to be recognised. If you want all
             CSS or JavaScript files to be processed by ASP.NET you can use the standard <span class="code">css</span> or <span class="code">js</span></li><li>Set <span class="code">Limit to</span> to <span class="code">GET</span>, select <span class="code">Script engine</span> and deselect <span class="code">Verify that file exists</span>. Click <span class="code">OK</span>.</li></ul><b>In <span class="code">web.config</span> when using IIS6:</b><p>Configure the HTTP handler, and in the path specify the same extensions you used in IIS:</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_4" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
     &lt;system.web&gt;
        &lt;httpHandlers&gt;
            &lt;add verb=<span class="highlight-literal">"GET"</span> path=<span class="highlight-literal">"*.cssx"</span> type=<span class="highlight-literal">"EsccWebTeam.Egms.CombineStaticFilesHandler,EsccWebTeam.Egms, Version=1.0.0.0, Culture=neutral, PublicKeyToken=06fad7304560ae6f"</span>/&gt;
            &lt;add verb=<span class="highlight-literal">"GET"</span> path=<span class="highlight-literal">"*.jsx"</span> type=<span class="highlight-literal">"EsccWebTeam.Egms.CombineStaticFilesHandler,EsccWebTeam.Egms, Version=1.0.0.0, Culture=neutral, PublicKeyToken=06fad7304560ae6f"</span>/&gt;
        &lt;/httpHandlers&gt;
     &lt;/system.web&gt;
&lt;/configuration&gt;</pre></div></span></div><b>In IIS 7 (method 1):</b><ul><li>Go to the application root from where you want to serve static files. This will typically be the root of the website. Under the features view double click on the <span class="code">Handler mappings</span> icon</li><li>Open the entry for any ASP.NET file type and copy the path to the ISAPI filter. For example you would copy PageHandlerFactory-ISAPI-2.0-64 if your application pool is setup against .Net 2.0 running on a 64bit OS</li><li>Next, under the actions heading click on the link <span class="code">Add Script Map</span></li><li>In the <span class="code">Request path</span> Enter a file extension, which must include the string <span class="code">"css"</span> or <span class="code">"js"</span> to be recognised. If you want all
             CSS or JavaScript files to be processed by ASP.NET you can use the standard <span class="code">css</span> or <span class="code">js</span> extensions; 
             otherwise use a custom extension such as <span class="code">cssx</span> or <span class="code">jsx</span>. </li><li>In the <span class="code">Executable</span> field paste in the path to the ISAPI filter</li><li>Next in the  <span class="code">Name</span> field enter the name to describe the handler  e.g. CSS Files</li><li>Click on the <span class="code">Request Restrictions</span> button to set the mappings, verbs and access settings</li><li>Leave the mappings tab alone and move on to verbs tab</li><li>Enter the<span class="code">Verb</span><span class="code">GET</span>, select <span class="code">Access</span> and then select <span class="code">Script</span>. Click <span class="code">OK</span> to confirm and <span class="code">Ok</span> again to the add new script mapping.</li><li>IIS will then try to update the web.config file, make sure it is checked out or you will get an access denied error on writing the changes.</li></ul><b>In IIS 7 (method 2):</b><p>Alternatively you can just add the two entries to <span class="code">web.config</span> yourself:</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_5" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
     &lt;system.webServer&gt;
        &lt;handlers&gt;
            &lt;add verb=<span class="highlight-literal">"GET"</span> path=<span class="highlight-literal">"*.cssx"</span> name=<span class="highlight-literal">"CssHandler"</span> type=<span class="highlight-literal">"EsccWebTeam.Egms.CombineStaticFilesHandler,EsccWebTeam.Egms, Version=1.0.0.0, Culture=neutral, PublicKeyToken=06fad7304560ae6f"</span>/&gt;
            &lt;add verb=<span class="highlight-literal">"GET"</span> path=<span class="highlight-literal">"*.jsx"</span> name=<span class="highlight-literal">"JsHandler"</span> type=<span class="highlight-literal">"EsccWebTeam.Egms.CombineStaticFilesHandler,EsccWebTeam.Egms, Version=1.0.0.0, Culture=neutral, PublicKeyToken=06fad7304560ae6f"</span>/&gt;
        &lt;/handlers&gt;
     &lt;/system.webServer&gt;
&lt;/configuration&gt;</pre></div></span></div><p>Specify a handler path for each type of file. This is the template for the combined links to your static files, 
             where <span class="code">{0}</span> will be replaced by the filename at run-time. In a development environment include <span class="code">{1}</span>, 
             which will be replaced at run-time by a random string, forcing the browser to download a new copy of the file with each 
             request machines. This complete path doesn't reference a real file, it's just a trigger to fire the HTTP handler, so it 
             must end with the file extension you registered above.</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_6" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
    &lt;CssFiles&gt;
        &lt;add key=<span class="highlight-literal">"HandlerPath"</span> value=<span class="highlight-literal">"/{0}-{1}-v1.cssx"</span> /&gt;
    &lt;/CssFiles&gt;

    &lt;ScriptFiles&gt;
        &lt;add key=<span class="highlight-literal">"HandlerPath"</span> value=<span class="highlight-literal">"/{0}-v2.jsx"</span> /&gt;
    &lt;/ScriptFiles&gt;
  &lt;/EsccWebTeam.Egms&gt;
&lt;/configuration&gt;</pre></div></span></div><p>Note the version number (<span class="code">-v1</span>). You can leave this out, but when you update your CSS or JavaScript files and you need to ensure users
             get the latest version rather than the old cached version, add or increment this number.</p><p>You can also specify the <span class="code">ID</span> of a <span class="nolink">ContentPlaceHolder</span> where the elements should appear on the rendered page. 
             CSS files are linked from the page &lt;head&gt;&lt;/head&gt; by default, but for JavaScript this lets you move all script file references to a placeholder at the 
             end of the page.</p><p>The order that files are loaded is altered automatically (alphabetically, by the key used to identify them). This makes the 
             generated filenames most consistent and therefore more likely to be cached, and for CSS it means the cascade will operate predictably because files 
             are loaded in the same order regardless of where on the page they were included. It can be important to override this though, for example when you need to have 
             JavaSCript library code loaded first, before other code that relies on it. In this case add a number between 1 and 9 followed by an underscore at the start of 
             the <span class="code">web.config</span> reference. Entries without a number will be treated like a 5. You don't need to remember the prefix when referencing the library on the page.</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_7" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
    &lt;ScriptFiles&gt;
        &lt;add key=<span class="highlight-literal">"HandlerPlaceholder"</span> value=<span class="highlight-literal">"javascript"</span> /&gt;

      &lt;add key=<span class="highlight-literal">"1_ExampleLibrary"</span> value=<span class="highlight-literal">"/example/library.js"</span> /&gt;
      &lt;add key=<span class="highlight-literal">"ExampleScript"</span> value=<span class="highlight-literal">"/example/script.js"</span> /&gt;
    &lt;/ScriptFiles&gt;
  &lt;/EsccWebTeam.Egms&gt;
&lt;/configuration&gt;</pre></div></span></div><p>Combined files are cached for 30 days by default. If you want to change this, set the <span class="code">HttpCacheDays</span> configuration setting.</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_8" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve">&lt;configuration&gt;
    &lt;CssFiles&gt;
        &lt;add key=<span class="highlight-literal">"HttpCacheDays"</span> value=<span class="highlight-literal">"60"</span> /&gt;
    &lt;/CssFiles&gt;
  &lt;/EsccWebTeam.Egms&gt;
&lt;/configuration&gt;</pre></div></span></div><p>The code for the handler was downloaded from <a href="http://archive.msdn.microsoft.com/HttpCombiner">http://archive.msdn.microsoft.com/HttpCombiner</a> and tweaked to fit our configuration.</p><p><b>Notes</b></p><ul><li><p>You should also minify your static files using a tool such as the <a href="http://developer.yahoo.com/yui/compressor/">YUI Compressor</a>, 
                 kicked off by a post-build action on your project such as:</p><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_9" x-lang="CSharp" codelanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="./CombineStaticFilesHandler_files/copycode(1).gif">Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">if</span> <span class="highlight-literal">"$(ConfigurationName)"</span> == <span class="highlight-literal">"Release"</span> java -jar <span class="highlight-literal">"$(ProjectDir)yuicompressor-2.3.5.jar"</span> <span class="highlight-literal">"$(ProjectDir)css/styles.css"</span> &gt; <span class="highlight-literal">"$(ProjectDir)css/min/styles.css"</span></pre></div></span></div></li><li>When you build <span class="code">EsccWebTeam.Egms.dll</span> in <span class="code">Debug</span> mode static files will be combined but not cached. This is so that you can 
             keep changing them while developing. Build in <span class="code">Release</span> mode to enable caching.</li><li>Rather than having separate stylesheets for older versions of Internet Explorer, use the conditional comments and <span class="code">.ie6</span>, <span class="code">.ie7</span> and <span class="code">.ie8</span>
             classes defined by <a href="http://www.modernizr.com/">Modernizr</a>.</li><li>Use an <span class="code">@media</span> rule to target specific media and combine your stylesheets using this method. This avoids the extra HTTP requests
             needed when you use the <span class="code">media</span> attribute of the &lt;link /&gt; element.</li><li>If you ever need to support another file type you need to create a new derived control like <a href="http://webcontent:9999/EsccWebTeam.Egms/html/cc589405-b1f1-9004-045b-bf9787a7512d.htm">Css</a> or <a href="http://webcontent:9999/EsccWebTeam.Egms/html/a0649da7-f2d9-34be-e024-35f86530b6e5.htm">Script</a>, 
             and update <a href="http://webcontent:9999/EsccWebTeam.Egms/html/7e09e5a0-1dbe-d530-e1a2-5a85d5d4fa1f.htm">ProcessRequest(HttpContext)</a> to recognise the file extension and use the correct media type.</li></ul></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><span class="nolink">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Object</span><br>&nbsp;&nbsp;<span class="selflink">EsccWebTeam.Egms<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>CombineStaticFilesHandler</span><br></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="./CombineStaticFilesHandler_files/collapse_all.gif" alt="Collapse image">See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="http://webcontent:9999/EsccWebTeam.Egms/html/0f717c85-76a2-15c0-c41f-9fb70808d06a.htm">CombineStaticFilesHandler Members</a></div><div class="seeAlsoStyle"><a href="http://webcontent:9999/EsccWebTeam.Egms/html/a73b95d3-f3f8-c86c-c924-1fc7e87db9f9.htm">EsccWebTeam.Egms Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="./CombineStaticFilesHandler_files/footer.gif" alt="Footer image" title="Footer image"></div><a name="feedback"></a><span id="fb" class="feedbackcss"></span></div></div></div></body></html>